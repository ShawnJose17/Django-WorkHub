{% extends 'base.html' %}
{% block title %}Job Posts | WorkHub{% endblock %}

{% block content %}
<h2 class="page-title" style="margin-bottom: 10px; margin-top: 30px; text-align: center;">Job Posts ({{ count }} posts)</h2>

<style>
    table, th, td {
        border: 2px solid black;
        border-collapse: collapse;
        text-align: center;
        padding: 10px;
        margin-left: -90px;
    }

    table {
        width: 100%;
    }

    .btn-secondary {
        width: 25%;
        margin-top: 25px;
        margin-left: 450px;
    }

    .btn-button {
        width: 25%;
        margin-top: 25px;
        margin-left: 450px;
        display: inline-block;
        background: #2596be;
        color: white !important;
        padding: 8px 14px;
        border-radius: 8px;
        font-size: 0.9rem;
        font-weight: 500;
        text-align: center;
        transition: background 0.2s ease;
    }

    .btn-button:hover {
        background: #1b7fa1;
    }

    .btn-delete {
        background: #2596be;
        border-radius: 8px;
        color: white !important;
        padding: 8px 14px;
        transition: background 0.2s ease;
    }

    .btn-delete:hover {
        background: #1b7fa1;
    }
</style>

<table class="data-table">
    <tr>
        <th>Position</th>
        <th>Company</th>
        <th>Location</th>
        <th>Salary</th>
        <th>Job Field</th>
        <th>Experience</th>
        <th>Description</th>
        <th>Requirements</th>
        <th>Phone</th>
        <th>Email</th>
        <th>Action</th>
    </tr>

    {% for job in posts %}
    <tr>
        <td>{{ job.job_position }}</td>
        <td>{{ job.company_name }}</td>
        <td>{{ job.location }}</td>
        <td>â‚¹{{ job.salary }}</td>
        <td>{{ job.job_field }}</td>
        <td>{{ job.experience }}</td>
        <td>{{ job.description }}</td>
        <td>{{ job.requirements }}</td>
        <td>{{ job.phone }}</td>
        <td>{{ job.email }}</td>
        <td>
            <button onclick="openDeleteModal('{{ job.id }}')" class="btn-delete" style="border: transparent;">Delete</button>
        </td>
    </tr>
    {% endfor %}
</table>

<a href="{% url 'whadmin:admin_home' %}" class="btn-button">Back</a>

<div id="deleteModal" class="modal" 
style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
background:rgba(0,0,0,0.5); justify-content:center; align-items:center;">
    <div style="background:white; padding:20px; border-radius:8px; width:300px; text-align:center;">
        <h3>Are you sure?</h3>
        <p>This action cannot be undone.</p>

        <form id="deleteForm" method="POST">
            {% csrf_token %}
            <button type="submit" class="btn-delete" style="border: transparent; margin-top: 10px;">Yes, Delete</button>
        </form>

        <button onclick="closeDeleteModal()" class="btn-delete" style="margin-top:10px; border: transparent;">Cancel</button>
    </div>
</div>

<script>
function openDeleteModal(jobId) {
    const modal = document.getElementById("deleteModal");
    const form = document.getElementById("deleteForm");

    form.action = `/whadmin/delete-job/${jobId}/`;
    modal.style.display = "flex";
}

function closeDeleteModal() {
    document.getElementById("deleteModal").style.display = "none";
}
</script>

{% endblock %}
