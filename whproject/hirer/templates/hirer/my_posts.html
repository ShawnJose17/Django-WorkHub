{% extends 'base.html' %}
{% block title %}My Job Posts | WorkHub{% endblock %}

{% block content %}
<h2 class="page-title" style="margin-top: 20px;">My Job Posts</h2>

{% for field, jobs in grouped_jobs.items %}
    {% if jobs %}
        <h3 class="job-field-heading">{{ field }}</h3>

        <div class="job-grid">
            {% for job in jobs %}
                <div class="job-card">
                    <h4>{{ job.job_position }}</h4>
                    <p class="company">{{ job.company_name }}</p>

                    <a href="{% url 'hirer:hirer_view_post' job.id %}" class="btn-secondary">View</a>
                    <a href="{% url 'hirer:hirer_edit_post' job.id %}" class="btn-secondary">Edit</a>

                    <button class="btn-secondary" onclick="openDeleteModal('{{ job.id }}')" style="border: transparent;">Delete</button>
                </div>
            {% endfor %}
        </div>
    {% endif %}
{% endfor %}

<div id="deleteModal" class="modal" style="
    display:none; position:fixed; top:0; left:0;
    width:100%; height:100%; background:rgba(0,0,0,0.5);
    justify-content:center; align-items:center;
">
    <div style="background:white; padding:20px; border-radius:8px; width:300px; text-align:center;">
        <h3>Are you sure?</h3>
        <p style="margin-bottom: 10px;">This action cannot be undone</p>

        <form id="deleteForm" method="POST">
            {% csrf_token %}
            <button type="submit" class="btn-secondary" style="border: transparent;">Yes, Delete</button>
        </form>

        <button onclick="closeDeleteModal()" class="btn-secondary" style="margin-top:10px; border: transparent;">Cancel</button>
    </div>
</div>

<script>
function openDeleteModal(jobId) {
    const modal = document.getElementById("deleteModal");
    const form = document.getElementById("deleteForm");

    form.action = `{% url 'hirer:hirer_delete_post' 0 %}`.replace("0", jobId);
    modal.style.display = "flex";
}

function closeDeleteModal() {
    document.getElementById("deleteModal").style.display = "none";
}
</script>

{% endblock %}
